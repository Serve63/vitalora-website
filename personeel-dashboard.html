<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Personeel Dashboard</title>
  <link rel="stylesheet" href="styles.css?v=2" />
  <link rel="stylesheet" href="/assets/css/header.css?v=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/fonts.css?v=12">
  <style>
    :root{--brand:#3A9AEA;--ink:#0f172a;--muted:#64748b}
    body{background:#f3f6fb}
    .app{display:grid;grid-template-columns:240px 1fr;min-height:calc(100vh - 64px)}
    
    .sidenav{background:#ffffff;border-right:1px solid #e5e7eb;padding:22px 16px}
    .sidenav h4{font-size:12px;color:#94a3b8;text-transform:uppercase;letter-spacing:.14em;margin-bottom:10px}

    .navlist{display:flex;flex-direction:column;gap:6px}
    .navlist a{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;color:#334155;text-decoration:none;font-weight:600}

    .navlist a.active,.navlist a:hover{background:#eef7fe;color:#1d4ed8}

    .content{padding:26px}
    .heading{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    .heading h1{margin:0;color:#333}
    .muted{color:var(--muted);font-size:14px}

    .kpi-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin:18px 0 24px}
    .kpi{grid-column:span 3;background:#ffffff;border:1px solid #e6edf7;border-radius:16px;box-shadow:0 2px 8px rgba(15,23,42,.06);padding:18px}

    .kpi h3{margin:0 0 8px;color:#334155;font-weight:700}
    .kpi .val{font-size:30px;font-weight:800;color:var(--ink)}
    .kpi .sub{font-size:12px;color:#94a3b8;margin-top:4px}

    .card{background:#fff;border:1px solid #e6edf7;border-radius:16px;box-shadow:0 10px 24px rgba(15,23,42,.06), inset 0 1px 0 #fff;padding:20px}

    .card h3{margin:0 0 10px;color:#333}
    table{width:100%;border-collapse:collapse}
    th,td{padding:12px 10px;border-bottom:1px solid #eef2f7;text-align:left;font-size:14px}
    th{color:#64748b;font-weight:700}

    @media(max-width:1024px){.kpi{grid-column:span 6}}
    @media(max-width:768px){.app{grid-template-columns:1fr}.sidenav{display:none}.kpi{grid-column:span 12}#blogs{display:none}}
    

  </style>
<link rel="icon" type="image/webp" href="/assets/images/vitalora logo.webp">
<link rel="shortcut icon" type="image/webp" href="/assets/images/vitalora logo.webp">
</head>
<body>
  <!-- Header -->
  <header class="site-header" role="banner">
    <div class="header-inner">
      <a class="logo" href="/">
        <span class="logo-text">Vitalora.nl</span>
      </a>
      
      <div class="header-buttons">
        <!-- Header buttons removed for dashboard -->
      </div>
    </div>
  </header>

  <div class="app">
    <aside class="sidenav">
      <h4>Menu</h4>
      <nav class="navlist">
        <a class="active" href="#">Overzicht</a>
        <a href="/klanten.html">Klanten</a>
      </nav>
    </aside>

    <main class="content">
      <div class="heading">
        <h1>Personeel Dashboard</h1>
      </div>

      <section class="kpi-grid">
        <div class="kpi"><h3>Alltime omzet</h3><div class="val">€ 0,00</div></div>

        <div class="kpi"><h3>Omzet dit jaar</h3><div class="val">€ 0,00</div></div>

        <div class="kpi"><h3>Omzet deze maand</h3><div class="val">€ 0,00</div></div>

        <div class="kpi"><h3>Omzet vandaag</h3><div class="val">€ 0,00</div></div>

      </section>

      <section id="blogs" class="card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; gap: 12px; flex-wrap: wrap;">
          <h3 style="margin: 0;">Blogbeheer</h3>
          <div style="display:flex; gap:8px; align-items:center;">
            <a href="/blog-editor.html" style="background: #10b981 !important; color: white !important; padding: 8px 16px !important; border-radius: 6px !important; text-decoration: none !important; font-weight: 600 !important; font-size: 14px !important; border: none !important; display: inline-block !important;">Blog aanmaken</a>
            <button id="export-posts" style="background:#2954B3;color:#fff;border:0;border-radius:6px;padding:8px 12px;font-weight:700;cursor:pointer">Exporteren</button>
            <button id="import-posts" style="background:#3A9AEA;color:#fff;border:0;border-radius:6px;padding:8px 12px;font-weight:700;cursor:pointer">Importeren</button>
            <button id="sync-feed" style="background:#64748b;color:#fff;border:0;border-radius:6px;padding:8px 12px;font-weight:700;cursor:pointer">Genereer feed</button>
            <input id="import-file" type="file" accept="application/json" style="display:none" />
          </div>
        </div>
        <p class="muted">Klik op een item om het bronbestand te openen. CMS-koppeling kan later toegevoegd worden.</p>

        <table>
          <thead><tr><th>Titel</th><th>Status</th></tr></thead>
          <tbody id="blog-posts-table">
          </tbody>
        </table>
      </section>

    </main>
  </div>



  <script>
    (function(){
      const key='staff_access_ok';
      if(localStorage.getItem(key)!=='1'){ window.location.href='/personeel'; return; }
      
      // Load and display blog posts in the table
      function loadBlogPosts() {
        const blogPosts = JSON.parse(localStorage.getItem('vitalora_blog_posts') || '[]');
        const tableBody = document.getElementById('blog-posts-table');
        
        if (!tableBody) return;
        
        // Clear existing rows
        tableBody.innerHTML = '';
        
        if (blogPosts.length === 0) {
          tableBody.innerHTML = '<tr><td colspan="2" style="text-align: center; color: #6b7280; padding: 20px;">Geen blog posts gevonden</td></tr>';
          return;
        }
        
        // Add each blog post as a table row
        blogPosts.forEach(function(post) {
          const row = document.createElement('tr');
          row.style.cursor = 'pointer';
          row.onclick = function() {
            // Open blog editor for editing
            window.open('/blog-editor.html?edit=' + post.id, '_blank');
          };
          
          const statusMap = {
            published: {label:'Gepubliceerd', bg:'#10b981'},
            draft: {label:'Concept', bg:'#6b7280'},
            scheduled: {label:'Ingepland', bg:'#f59e0b'},
            offline: {label:'Offline', bg:'#ef4444'}
          };
          const meta = statusMap[post.status] || statusMap.published;
          row.innerHTML = `
            <td style="padding: 12px 10px; border-bottom: 1px solid #eef2f7; color: #333333;">${post.title}</td>
            <td style="padding: 12px 10px; border-bottom: 1px solid #eef2f7; color: #333333;">
              <span style="background: ${meta.bg}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 600;">
                ${meta.label}
              </span>
            </td>
          `;
          
          tableBody.appendChild(row);
        });
      }
      
      function downloadFile(filename, text) {
        const blob = new Blob([text], {type: 'application/json;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        setTimeout(() => { URL.revokeObjectURL(url); document.body.removeChild(a); }, 0);
      }

      // Export posts
      const exportBtn = document.getElementById('export-posts');
      if (exportBtn) {
        exportBtn.onclick = function(){
          const posts = JSON.parse(localStorage.getItem('vitalora_blog_posts') || '[]');
          downloadFile('blog-posts-export.json', JSON.stringify(posts, null, 2));
        };
      }

      // Import posts (merge by slug)
      const importBtn = document.getElementById('import-posts');
      const importInput = document.getElementById('import-file');
      if (importBtn && importInput) {
        importBtn.onclick = () => importInput.click();
        importInput.onchange = function(ev){
          const file = ev.target.files && ev.target.files[0];
          if (!file) return;
          const reader = new FileReader();
          reader.onload = function(e){
            try {
              const imported = JSON.parse(String(e.target.result || '[]'));
              if (!Array.isArray(imported)) { alert('Ongeldig JSON-formaat'); return; }
              let current = JSON.parse(localStorage.getItem('vitalora_blog_posts') || '[]');
              const bySlug = new Map(current.map(p => [p.slug, p]));
              imported.forEach(p => {
                if (!p || !p.slug) return;
                if (bySlug.has(p.slug)) {
                  const existing = bySlug.get(p.slug);
                  const merged = { ...existing, ...p };
                  bySlug.set(p.slug, merged);
                } else {
                  bySlug.set(p.slug, p);
                }
              });
              current = Array.from(bySlug.values());
              localStorage.setItem('vitalora_blog_posts', JSON.stringify(current));
              alert('Import voltooid. ' + current.length + ' posts in totaal.');
              loadBlogPosts();
              importInput.value = '';
            } catch(err){
              alert('Import mislukt: ' + err.message);
            }
          };
          reader.readAsText(file);
        };
      }

      // Generate simple feed JSON for site commit
      const syncBtn = document.getElementById('sync-feed');
      if (syncBtn) {
        syncBtn.onclick = function(){
          const posts = JSON.parse(localStorage.getItem('vitalora_blog_posts') || '[]')
            .filter(p => (p.status || 'published') === 'published')
            .map((p, idx) => ({
              id: p.id || (idx+1),
              slug: p.slug,
              title: p.title,
              publishedDate: p.publishedDate || p.publishDate || '',
              readTime: p.readTime || Math.max(3, Math.ceil(String(p.content||'').replace(/<[^>]*>/g,'').split(/\s+/).length/200))
            }));
          downloadFile('blog-feed.json', JSON.stringify(posts, null, 2));
        };
      }

      // Load blog posts when page loads
      loadBlogPosts();
      
      // Reload blog posts every 5 seconds to catch new publications
      setInterval(loadBlogPosts, 5000);
    })();
  </script>
</body>
</html>