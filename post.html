<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blog – Vitalora</title>
  <link rel="stylesheet" href="styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    .post-shell{padding:80px 0}
    .post-container{max-width:860px;margin:0 auto;padding:0 20px}
    .post-title{font-size:36px;font-weight:800;color:#333;margin-bottom:16px}
    .post-meta{color:#6b7280;margin-bottom:24px}
    .post-body{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:24px}
    .back{display:inline-block;margin-top:16px;color:#3A9AEA;font-weight:600;text-decoration:none}
  </style>
</head>
<body>
  <header class="main-header">
    <div class="container">
      <div class="header-content">
        <div class="logo" onclick="window.location.href='/'"><span class="logo-text">Vitalora.nl</span></div>
        				<nav class="header-nav"><a class="nav-link" href="/blog">Blogs</a></nav>
      </div>
    </div>
  </header>

  <main class="post-shell">
    <div class="post-container">
      <h1 id="post-title" class="post-title">Laden...</h1>
      <div id="post-meta" class="post-meta"></div>
      <div id="post-content" class="post-body">Nog invullen.</div>
    </div>
  </main>

  <script>
    (async function(){
      const params = new URLSearchParams(location.search);
      const slug = params.get('slug') || '';

      const titleEl = document.getElementById('post-title');
      const metaEl = document.getElementById('post-meta');
      const contentEl = document.getElementById('post-content');

      if (!slug) {
        titleEl.textContent = 'Blog post niet gevonden';
        contentEl.innerHTML = '<p>Geen slug opgegeven.</p>';
        return;
      }

      // Toon basis info
      titleEl.textContent = slug.replace(/-/g,' ').replace(/\b\w/g, c => c.toUpperCase());
      metaEl.textContent = '/' + slug;

      // 1) Probeer uit localStorage (van jouw CRM)
      let post = null;
      try {
        const posts = JSON.parse(localStorage.getItem('vitalora_blog_posts') || '[]');
        post = posts.find(p => (p.slug === slug));
      } catch (e) {
        // ignore
      }

      // 2) Fallback: probeer statische HTML te halen en te parsen
      async function fetchStatic(sl){
        try {
          const res = await fetch('/' + encodeURIComponent(sl) + '.html', { credentials: 'same-origin' });
          if (!res.ok) return null;
          const html = await res.text();
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const h1 = doc.querySelector('.blog-title, h1');
          const content = doc.querySelector('.blog-content, article, main');
          const dateEl = doc.querySelector('.blog-date');
          const parsed = {
            title: h1 ? h1.textContent.trim() : slug.replace(/-/g,' '),
            content: content ? content.innerHTML : '<p>Geen inhoud gevonden.</p>',
            publishedDate: dateEl ? dateEl.textContent.trim() : ''
          };
          return parsed;
        } catch (e) {
          return null;
        }
      }

      if (!post) {
        post = await fetchStatic(slug);
      }

      if (!post) {
        // Niets gevonden
        contentEl.innerHTML = '<p>Deze blog post kon niet worden gevonden.</p>';
        return;
      }

      // Toon post data
      document.title = (post.metaTitle || post.title || titleEl.textContent) + ' - Vitalora';
      titleEl.textContent = post.title || titleEl.textContent;
      if (post.publishedDate) {
        metaEl.textContent = '/' + slug + ' · ' + post.publishedDate + (post.readTime ? (' · ' + post.readTime + ' min') : '');
      }
      if (post.content) {
        contentEl.innerHTML = post.content;
      }

    })();
  </script>
</body>
</html>

